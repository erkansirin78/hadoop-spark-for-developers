{"paragraphs":[{"user":"anonymous","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571294121818_1438693973","id":"20191017-063521_1358211443","dateCreated":"2019-10-17T06:35:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1744","text":"%pyspark\ndf = spark.read.format(\"csv\") \\\n.option(\"header\", True) \\\n.option(\"inferSchema\", True) \\\n.option(\"sep\", \",\") \\\n.load(\"/user/admin/simple_data.csv\")","dateUpdated":"2019-10-17T06:41:21+0000","dateFinished":"2019-10-17T06:41:22+0000","dateStarted":"2019-10-17T06:41:21+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf.show(3)","user":"anonymous","dateUpdated":"2019-10-17T06:41:44+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571294481569_1849940762","id":"20191017-064121_375536028","dateCreated":"2019-10-17T06:41:21+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1807","dateFinished":"2019-10-17T06:41:44+0000","dateStarted":"2019-10-17T06:41:44+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+------+-----+---+--------+--------+-----------+\n|sirano| isim|yas|  meslek|   sehir|aylik_gelir|\n+------+-----+---+--------+--------+-----------+\n|     1|Cemal| 35|    Isci|  Ankara|       3500|\n|     2|Ceyda| 42|   Memur| Kayseri|       4200|\n|     3|Timur| 30|Müzisyen|Istanbul|       9000|\n+------+-----+---+--------+--------+-----------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\nfrom pyspark.sql import functions as F\ndf.select(df.meslek, F.when(df.meslek.isNull(), \"Unknown\").otherwise(df.meslek).alias(\"meslek\")).show()","user":"anonymous","dateUpdated":"2019-10-17T06:49:56+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571294504768_36649844","id":"20191017-064144_25748898","dateCreated":"2019-10-17T06:41:44+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1876","dateFinished":"2019-10-17T06:49:56+0000","dateStarted":"2019-10-17T06:49:56+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-----------+-----------+\n|     meslek|     meslek|\n+-----------+-----------+\n|       Isci|       Isci|\n|      Memur|      Memur|\n|   Müzisyen|   Müzisyen|\n|Pazarlamaci|Pazarlamaci|\n|       null|    Unknown|\n|      Memur|      Memur|\n|Pazarlamaci|Pazarlamaci|\n|   Müzisyen|   Müzisyen|\n|     Doktor|     Doktor|\n|     Berber|     Berber|\n| Tuhafiyeci| Tuhafiyeci|\n|    Tornacı|    Tornacı|\n|      Memur|      Memur|\n|     Doktor|     Doktor|\n|       null|    Unknown|\n|     Berber|     Berber|\n|     Berber|     Berber|\n+-----------+-----------+\n\n"}]}},{"text":"%pyspark\norder_items_df = spark.read.format(\"csv\") \\\n.option(\"header\", True) \\\n.option(\"inferSchema\", True) \\\n.option(\"sep\", \",\") \\\n.load(\"/user/maria_dev/order_items.csv\")\n\norder_items_df.show(3)","user":"anonymous","dateUpdated":"2019-10-17T07:19:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571294884057_1124823714","id":"20191017-064804_618356504","dateCreated":"2019-10-17T06:48:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2134","dateFinished":"2019-10-17T07:19:09+0000","dateStarted":"2019-10-17T07:19:07+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+----------------+------------------+-----------------+-----------------+---------------------+\n|orderItemName|orderItemOrderId|orderItemProductId|orderItemQuantity|orderItemSubTotal|orderItemProductPrice|\n+-------------+----------------+------------------+-----------------+-----------------+---------------------+\n|            1|               1|               957|                1|           299.98|               299.98|\n|            2|               2|              1073|                1|           199.99|               199.99|\n|            3|               2|               502|                5|            250.0|                 50.0|\n+-------------+----------------+------------------+-----------------+-----------------+---------------------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\nproducts_df = spark.read.format(\"csv\") \\\n.option(\"header\", True) \\\n.option(\"inferSchema\", True) \\\n.option(\"sep\", \",\") \\\n.load(\"/user/maria_dev/products.csv\")\n\nproducts_df.show(3)","user":"anonymous","dateUpdated":"2019-10-17T07:19:34+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571294884032_1122130471","id":"20191017-064804_1781243486","dateCreated":"2019-10-17T06:48:04+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2078","dateFinished":"2019-10-17T07:19:35+0000","dateStarted":"2019-10-17T07:19:34+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------+-----------------+--------------------+------------------+------------+--------------------+\n|productId|productCategoryId|         productName|productDescription|productPrice|        productImage|\n+---------+-----------------+--------------------+------------------+------------+--------------------+\n|        1|                2|Quest Q64 10 FT. ...|              null|       59.98|http://images.acm...|\n|        2|                2|Under Armour Men'...|              null|      129.99|http://images.acm...|\n|        3|                2|Under Armour Men'...|              null|       89.99|http://images.acm...|\n+---------+-----------------+--------------------+------------------+------------+--------------------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\njoined_df = order_items_df.join(products_df, order_items_df.orderItemProductId == products_df.productId, \"inner\")\n\njoined_df.show(3)","user":"anonymous","dateUpdated":"2019-10-17T07:21:26+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571294883593_-186400538","id":"20191017-064803_1711721","dateCreated":"2019-10-17T06:48:03+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2022","dateFinished":"2019-10-17T07:21:26+0000","dateStarted":"2019-10-17T07:21:26+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+-------------+----------------+------------------+-----------------+-----------------+---------------------+---------+-----------------+--------------------+------------------+------------+--------------------+\n|orderItemName|orderItemOrderId|orderItemProductId|orderItemQuantity|orderItemSubTotal|orderItemProductPrice|productId|productCategoryId|         productName|productDescription|productPrice|        productImage|\n+-------------+----------------+------------------+-----------------+-----------------+---------------------+---------+-----------------+--------------------+------------------+------------+--------------------+\n|            1|               1|               957|                1|           299.98|               299.98|      957|               43|Diamondback Women...|              null|      299.98|http://images.acm...|\n|            2|               2|              1073|                1|           199.99|               199.99|     1073|               48|Pelican Sunstream...|              null|      199.99|http://images.acm...|\n|            3|               2|               502|                5|            250.0|                 50.0|      502|               24|Nike Men's Dri-FI...|              null|        50.0|http://images.acm...|\n+-------------+----------------+------------------+-----------------+-----------------+---------------------+---------+-----------------+--------------------+------------------+------------+--------------------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\nz.show(joined_df.limit(5))","user":"anonymous","dateUpdated":"2019-10-17T07:22:09+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571294882940_-119838978","id":"20191017-064802_172168027","dateCreated":"2019-10-17T06:48:02+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:1966","dateFinished":"2019-10-17T07:22:09+0000","dateStarted":"2019-10-17T07:22:09+0000","results":{"code":"SUCCESS","msg":[{"type":"TABLE","data":"orderItemName\torderItemOrderId\torderItemProductId\torderItemQuantity\torderItemSubTotal\torderItemProductPrice\tproductId\tproductCategoryId\tproductName\tproductDescription\tproductPrice\tproductImage\n1\t1\t957\t1\t299.98\t299.98\t957\t43\tDiamondback Women's Serene Classic Comfort Bi\tnull\t299.98\thttp://images.acmesports.sports/Diamondback+Women%27s+Serene+Classic+Comfort+Bike+2014\n2\t2\t1073\t1\t199.99\t199.99\t1073\t48\tPelican Sunstream 100 Kayak\tnull\t199.99\thttp://images.acmesports.sports/Pelican+Sunstream+100+Kayak\n3\t2\t502\t5\t250.0\t50.0\t502\t24\tNike Men's Dri-FIT Victory Golf Polo\tnull\t50.0\thttp://images.acmesports.sports/Nike+Men%27s+Dri-FIT+Victory+Golf+Polo\n4\t2\t403\t1\t129.99\t129.99\t403\t18\tNike Men's CJ Elite 2 TD Football Cleat\tnull\t129.99\thttp://images.acmesports.sports/Nike+Men%27s+CJ+Elite+2+TD+Football+Cleat\n5\t4\t897\t2\t49.98\t24.99\t897\t40\tTeam Golf New England Patriots Putter Grip\tnull\t24.99\thttp://images.acmesports.sports/Team+Golf+New+England+Patriots+Putter+Grip\n"}]}},{"text":"%pyspark\ndf2 = joined_df.groupBy(\"productName\") \\\n.agg({\"orderItemSubTotal\": \"sum\"})","user":"anonymous","dateUpdated":"2019-10-17T07:27:50+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571296916502_1840736316","id":"20191017-072156_33569109","dateCreated":"2019-10-17T07:21:56+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2334","dateFinished":"2019-10-17T07:27:50+0000","dateStarted":"2019-10-17T07:27:50+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf2.show(2)","user":"anonymous","dateUpdated":"2019-10-17T07:27:59+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571296997954_-555171706","id":"20191017-072317_1263037459","dateCreated":"2019-10-17T07:23:17+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2500","dateFinished":"2019-10-17T07:28:00+0000","dateStarted":"2019-10-17T07:27:59+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+----------------------+\n|         productName|sum(orderItemSubTotal)|\n+--------------------+----------------------+\n|Field & Stream Sp...|    6929653.5000018785|\n|Bag Boy Beverage ...|    21116.549999999985|\n+--------------------+----------------------+\nonly showing top 2 rows\n\n"}]}},{"text":"%pyspark\ndf3 = df2.withColumnRenamed(\"sum(orderItemSubTotal)\",\"total\")\n","user":"anonymous","dateUpdated":"2019-10-17T07:30:52+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571297279360_418241367","id":"20191017-072759_633065995","dateCreated":"2019-10-17T07:27:59+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2723","dateFinished":"2019-10-17T07:30:53+0000","dateStarted":"2019-10-17T07:30:52+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf3.show(3)","user":"anonymous","dateUpdated":"2019-10-17T07:31:12+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571297323585_320407877","id":"20191017-072843_203294976","dateCreated":"2019-10-17T07:28:43+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2806","dateFinished":"2019-10-17T07:31:12+0000","dateStarted":"2019-10-17T07:31:12+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+--------------------+------------------+\n|         productName|             total|\n+--------------------+------------------+\n|Field & Stream Sp...|6929653.5000018785|\n|Bag Boy Beverage ...|21116.549999999985|\n|Team Golf Pittsbu...|22166.129999999983|\n+--------------------+------------------+\nonly showing top 3 rows\n\n"}]}},{"text":"%pyspark\nfrom pyspark.sql import functions as F","user":"anonymous","dateUpdated":"2019-10-17T07:33:58+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571297445118_2138300981","id":"20191017-073045_1112403363","dateCreated":"2019-10-17T07:30:45+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:2943","dateFinished":"2019-10-17T07:33:59+0000","dateStarted":"2019-10-17T07:33:59+0000","results":{"code":"SUCCESS","msg":[]}},{"text":"%pyspark\ndf3.sort(F.desc(\"total\")) \\\n.withColumn(\"total_format\", F.format_number(df3.total,2)) \\\n.show(truncate=False)","user":"anonymous","dateUpdated":"2019-10-17T07:36:49+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"python"},"editorMode":"ace/mode/python"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571297513523_-762043497","id":"20191017-073153_1199713306","dateCreated":"2019-10-17T07:31:53+0000","status":"FINISHED","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3062","dateFinished":"2019-10-17T07:36:52+0000","dateStarted":"2019-10-17T07:36:50+0000","results":{"code":"SUCCESS","msg":[{"type":"TEXT","data":"+---------------------------------------------+------------------+------------+\n|productName                                  |total             |total_format|\n+---------------------------------------------+------------------+------------+\n|Field & Stream Sportsman 16 Gun Fire Safe    |6929653.5000018785|6,929,653.50|\n|Perfect Fitness Perfect Rip Deck             |4421143.020000857 |4,421,143.02|\n|Diamondback Women's Serene Classic Comfort Bi|4118425.419999785 |4,118,425.42|\n|Nike Men's Free 5.0+ Running Shoe            |3667633.2000002544|3,667,633.20|\n|Nike Men's Dri-FIT Victory Golf Polo         |3147800.0         |3,147,800.00|\n|Pelican Sunstream 100 Kayak                  |3099845.000000588 |3,099,845.00|\n|Nike Men's CJ Elite 2 TD Football Cleat      |2891757.540000606 |2,891,757.54|\n|O'Brien Men's Neoprene Life Vest             |2888993.9399994123|2,888,993.94|\n|Under Armour Girls' Toddler Spine Surge Runni|1269082.6499998544|1,269,082.65|\n|adidas Youth Germany Black/Red Away Match Soc|67830.0           |67,830.00   |\n|LIJA Women's Eyelet Sleeveless Golf Polo     |61490.0           |61,490.00   |\n|adidas Men's F10 Messi TRX FG Soccer Cleat   |56330.60999999992 |56,330.61   |\n|Titleist Pro V1x High Numbers Personalized Go|47206.92000000003 |47,206.92   |\n|Under Armour Women's Micro G Skulpt Running S|46559.59000000002 |46,559.59   |\n|Nike Men's Comfort 2 Slide                   |44585.090000000026|44,585.09   |\n|Titleist Pro V1 High Numbers Personalized Gol|44243.49000000003 |44,243.49   |\n|Titleist Pro V1x Golf Balls                  |41415.37000000004 |41,415.37   |\n|Titleist Pro V1x High Numbers Golf Balls     |38392.00000000001 |38,392.00   |\n|Under Armour Men's Compression EV SL Slide   |36576.87000000003 |36,576.87   |\n|TYR Boys' Team Digi Jammer                   |35191.20000000005 |35,191.20   |\n+---------------------------------------------+------------------+------------+\nonly showing top 20 rows\n\n"}]}},{"text":"%pyspark\n","user":"anonymous","dateUpdated":"2019-10-17T07:34:07+0000","config":{"colWidth":12,"enabled":true,"results":{},"editorSetting":{"language":"scala"},"editorMode":"ace/mode/scala"},"settings":{"params":{},"forms":{}},"apps":[],"jobName":"paragraph_1571297647753_-1426303989","id":"20191017-073407_2058605671","dateCreated":"2019-10-17T07:34:07+0000","status":"READY","progressUpdateIntervalMs":500,"focus":true,"$$hashKey":"object:3199"}],"name":"python_spark_2","id":"2ERPEQ26U","angularObjects":{"2CHS8UYQQ:shared_process":[],"2C8A4SZ9T_livy2:shared_process":[],"2CK8A9MEG:shared_process":[],"2C4U48MY3_spark2:shared_process":[],"2CKAY1A8Y:shared_process":[],"2CKEKWY8Z:shared_process":[]},"config":{"isZeppelinNotebookCronEnable":false,"looknfeel":"default","personalizedMode":"false"},"info":{}}